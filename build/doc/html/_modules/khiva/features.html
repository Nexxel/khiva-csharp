

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>khiva.features &mdash; Khiva v0.2.2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Khiva
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/main.html">1. API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../text/faq.html">2. FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">3. License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../authors.html">4. Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../text/how_to_contribute.html">5. How to contribute</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Khiva</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>khiva.features</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for khiva.features</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#</span>
<span class="c1"># Copyright (c) 2019 Shapelets.io</span>
<span class="c1">#</span>
<span class="c1"># This Source Code Form is subject to the terms of the Mozilla Public</span>
<span class="c1"># License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<span class="c1"># file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>

<span class="c1">########################################################################################################################</span>
<span class="c1"># IMPORT</span>
<span class="c1">########################################################################################################################</span>
<span class="kn">import</span> <span class="nn">ctypes</span>
<span class="kn">from</span> <span class="nn">khiva.library</span> <span class="kn">import</span> <span class="n">KhivaLibrary</span>
<span class="kn">from</span> <span class="nn">khiva.array</span> <span class="kn">import</span> <span class="n">Array</span>


<span class="c1">########################################################################################################################</span>


<div class="viewcode-block" id="abs_energy"><a class="viewcode-back" href="../../khiva.html#khiva.features.abs_energy">[docs]</a><span class="k">def</span> <span class="nf">abs_energy</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the sum over the square values of the time series.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :type arr: khiva.array</span>
<span class="sd">    :return: KHIVA array with the absEnergy.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">abs_energy</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                              <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="absolute_sum_of_changes"><a class="viewcode-back" href="../../khiva.html#khiva.features.absolute_sum_of_changes">[docs]</a><span class="k">def</span> <span class="nf">absolute_sum_of_changes</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the value of an aggregation function f_agg (e.g. var or mean) of the autocorrelation</span>
<span class="sd">    (Compare to http://en.wikipedia.org/wiki/Autocorrelation#Estimation), taken over different all possible</span>
<span class="sd">    lags (1 to length of x)</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :type arr: khiva.array</span>
<span class="sd">    :return: KHIVA array with the absolute sum of changes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">absolute_sum_of_changes</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                           <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="aggregated_autocorrelation"><a class="viewcode-back" href="../../khiva.html#khiva.features.aggregated_autocorrelation">[docs]</a><span class="k">def</span> <span class="nf">aggregated_autocorrelation</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">aggregation_function</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates a linear least-squares regression for values of the time series that were aggregated</span>
<span class="sd">    over chunks versus the sequence from 0 up to the number of chunks minus one.</span>

<span class="sd">    :param arr: A KHIVA array with the time series.</span>
<span class="sd">    :param aggregation_function: Function to be used in the aggregation. It receives an integer which indicates</span>
<span class="sd">                                the function to be applied.</span>
<span class="sd">                                0 : mean,</span>
<span class="sd">                                1 : median</span>
<span class="sd">                                2 : min,</span>
<span class="sd">                                3 : max,</span>
<span class="sd">                                4 : stdev,</span>
<span class="sd">                                5 : var,</span>
<span class="sd">                                default : mean</span>

<span class="sd">    :return: KHIVA array that contains the aggregated correlation for each time series.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">aggregated_autocorrelation</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                              <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">aggregation_function</span><span class="p">)),</span>
                                                              <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="aggregated_linear_trend"><a class="viewcode-back" href="../../khiva.html#khiva.features.aggregated_linear_trend">[docs]</a><span class="k">def</span> <span class="nf">aggregated_linear_trend</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">chunk_size</span><span class="p">,</span> <span class="n">aggregation_function</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates a linear least-squares regression for values of the time series that were aggregated</span>
<span class="sd">    over chunks versus the sequence from 0 up to the number of chunks minus one.</span>

<span class="sd">    :param arr: A KHIVA array with the time series.</span>
<span class="sd">    :param chunk_size: The chunk size used to aggregate the data.</span>
<span class="sd">    :param aggregation_function: Function to be used in the aggregation. It receives an integer which indicates the</span>
<span class="sd">                                function to be applied:</span>
<span class="sd">                                0 : mean,</span>
<span class="sd">                                1 : median</span>
<span class="sd">                                2 : min,</span>
<span class="sd">                                3 : max,</span>
<span class="sd">                                4 : stdev,</span>
<span class="sd">                                default : mean</span>
<span class="sd">    :return: ( pvalue: KHIVA array with the pvalues for all time series.</span>
<span class="sd">            rvalue: KHIVA array with the rvalues for all time series.</span>
<span class="sd">            intercept: KHIVA array with the intercept values for all time series.</span>
<span class="sd">            slope: KHIVA array with the slope for all time series.</span>
<span class="sd">            stdrr: KHIVA array with the stderr values for all time series. )</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">aggregated_linear_trend</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                           <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_long</span><span class="p">(</span><span class="n">chunk_size</span><span class="p">)),</span>
                                                           <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">aggregation_function</span><span class="p">)),</span>
                                                           <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">),</span>
                                                           <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">c</span><span class="p">),</span>
                                                           <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">d</span><span class="p">),</span>
                                                           <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
                                                           <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">),</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">c</span><span class="p">,</span>
                                           <span class="n">khiva_type</span><span class="o">=</span><span class="n">arr</span><span class="o">.</span><span class="n">khiva_type</span><span class="p">),</span> <span class="n">Array</span><span class="p">(</span>
        <span class="n">array_reference</span><span class="o">=</span><span class="n">d</span><span class="p">),</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">e</span><span class="p">),</span> <span class="n">Array</span><span class="p">(</span>
        <span class="n">array_reference</span><span class="o">=</span><span class="n">f</span><span class="p">)</span></div>


<div class="viewcode-block" id="approximate_entropy"><a class="viewcode-back" href="../../khiva.html#khiva.features.approximate_entropy">[docs]</a><span class="k">def</span> <span class="nf">approximate_entropy</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates a vectorized Approximate entropy algorithm.</span>
<span class="sd">    https://en.wikipedia.org/wiki/Approximate_entropy</span>
<span class="sd">    For short time-series this method is highly dependent on the parameters, but should be stable for N &gt; 2000,</span>
<span class="sd">    see: Yentes et al. (2012) - The Appropriate Use of Approximate Entropy and Sample Entropy with Short Data Sets</span>
<span class="sd">    Other shortcomings and alternatives discussed in:</span>
<span class="sd">    Richman &amp; Moorman (2000) - Physiological time-series analysis using approximate entropy and sample entropy</span>


<span class="sd">    :param arr: A KHIVA array with the time series.</span>
<span class="sd">    :param m: Length of compared run of data.</span>
<span class="sd">    :param r: Filtering level, must be positive.</span>
<span class="sd">    :return: KHIVA array with the vectorized approximate entropy for all the input time series in tss.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">approximate_entropy</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                       <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">m</span><span class="p">)),</span>
                                                       <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">(</span><span class="n">r</span><span class="p">)),</span>
                                                       <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="cross_covariance"><a class="viewcode-back" href="../../khiva.html#khiva.features.cross_covariance">[docs]</a><span class="k">def</span> <span class="nf">cross_covariance</span><span class="p">(</span><span class="n">xss</span><span class="p">,</span> <span class="n">yss</span><span class="p">,</span> <span class="n">unbiased</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the cross-covariance of the given time series.</span>

<span class="sd">    :param xss: A KHIVA array with time series.</span>
<span class="sd">    :param yss: A KHIVA Array with time series.</span>
<span class="sd">    :param unbiased: Determines whether it divides by n - lag (if true) or n (if false).</span>
<span class="sd">    :return: KHIVA array with the cross-covariance value for the given time series.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">cross_covariance</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">xss</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                    <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">yss</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                    <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_bool</span><span class="p">(</span><span class="n">unbiased</span><span class="p">)),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="auto_covariance"><a class="viewcode-back" href="../../khiva.html#khiva.features.auto_covariance">[docs]</a><span class="k">def</span> <span class="nf">auto_covariance</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">unbiased</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the auto-covariance the given time series.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :param unbiased: Determines whether it divides by n - lag (if true) or n (if false).</span>
<span class="sd">    :return: KHIVA array with the auto-covariance value for the given time series.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">auto_covariance</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                   <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_bool</span><span class="p">(</span><span class="n">unbiased</span><span class="p">)),</span>
                                                   <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="cross_correlation"><a class="viewcode-back" href="../../khiva.html#khiva.features.cross_correlation">[docs]</a><span class="k">def</span> <span class="nf">cross_correlation</span><span class="p">(</span><span class="n">xss</span><span class="p">,</span> <span class="n">yss</span><span class="p">,</span> <span class="n">unbiased</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the cross-correlation of the given time series.</span>

<span class="sd">    :param xss: KHIVA array with the time series.</span>
<span class="sd">    :param yss: KHIVA array with the time series.</span>
<span class="sd">    :param unbiased: Determines whether it divides by n - lag (if true) or n (if false).</span>
<span class="sd">    :return: KHIVA array with cross-correlation value for the given time series.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">cross_correlation</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">xss</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                     <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">yss</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                     <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_bool</span><span class="p">(</span><span class="n">unbiased</span><span class="p">)),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="auto_correlation"><a class="viewcode-back" href="../../khiva.html#khiva.features.auto_correlation">[docs]</a><span class="k">def</span> <span class="nf">auto_correlation</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">max_lag</span><span class="p">,</span> <span class="n">unbiased</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the autocorrelation of the specified lag for the given time series.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :param max_lag: The maximum lag to compute.</span>
<span class="sd">    :param unbiased: Determines whether it divides by n - lag (if true) or n (if false).</span>
<span class="sd">    :return: KHIVA array with the autocorrelation value for the given time series.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">auto_correlation</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                    <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_long</span><span class="p">(</span><span class="n">max_lag</span><span class="p">)),</span>
                                                    <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_bool</span><span class="p">(</span><span class="n">unbiased</span><span class="p">)),</span>
                                                    <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="binned_entropy"><a class="viewcode-back" href="../../khiva.html#khiva.features.binned_entropy">[docs]</a><span class="k">def</span> <span class="nf">binned_entropy</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">max_bins</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the binned entropy for the given time series and number of bins.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :param max_bins: The number of bins.</span>
<span class="sd">    :return: KHIVA array with the binned entropy value for the given time series.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">binned_entropy</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                  <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">max_bins</span><span class="p">)),</span>
                                                  <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="c3"><a class="viewcode-back" href="../../khiva.html#khiva.features.c3">[docs]</a><span class="k">def</span> <span class="nf">c3</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">lag</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the Schreiber, T. and Schmitz, A. (1997) measure of non-linearity</span>
<span class="sd">    for the given time series</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :param lag: The lag.</span>
<span class="sd">    :return: KHIVA array with non-linearity value for the given time series.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">c3</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                      <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_long</span><span class="p">(</span><span class="n">lag</span><span class="p">)),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="cid_ce"><a class="viewcode-back" href="../../khiva.html#khiva.features.cid_ce">[docs]</a><span class="k">def</span> <span class="nf">cid_ce</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">z_normalize</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates an estimate for the time series complexity defined by</span>
<span class="sd">    Batista, Gustavo EAPA, et al (2014). (A more complex time series has more peaks,</span>
<span class="sd">    valleys, etc.)</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :param z_normalize: Controls wheter the time series should be z-normalized or not.</span>
<span class="sd">    :return: KHIVA array with the complexity value for the given time series.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">cid_ce</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                          <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_bool</span><span class="p">(</span><span class="n">z_normalize</span><span class="p">)),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="count_above_mean"><a class="viewcode-back" href="../../khiva.html#khiva.features.count_above_mean">[docs]</a><span class="k">def</span> <span class="nf">count_above_mean</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the number of values in the time series that are higher than</span>
<span class="sd">    the mean.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :return: KHIVA array with the number of values in the time series that are higher than the mean.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">count_above_mean</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                    <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="count_below_mean"><a class="viewcode-back" href="../../khiva.html#khiva.features.count_below_mean">[docs]</a><span class="k">def</span> <span class="nf">count_below_mean</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the number of values in the time series that are lower than</span>
<span class="sd">    the mean.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :return: KHIVA Array with the number of values in the time series that are lower than the mean.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">count_below_mean</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                    <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="cwt_coefficients"><a class="viewcode-back" href="../../khiva.html#khiva.features.cwt_coefficients">[docs]</a><span class="k">def</span> <span class="nf">cwt_coefficients</span><span class="p">(</span><span class="n">tss</span><span class="p">,</span> <span class="n">widths</span><span class="p">,</span> <span class="n">coeff</span><span class="p">,</span> <span class="n">w</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates a Continuous wavelet transform for the Ricker wavelet, also known as</span>
<span class="sd">    the &quot;Mexican hat wavelet&quot;.</span>

<span class="sd">    :param tss: KHIVA array with the time series.</span>
<span class="sd">    :param widths: Widths. It accepts a list of lists or a numpy array with one or several widths.</span>
<span class="sd">    :param coeff: Coefficient of interest.</span>
<span class="sd">    :param w: Width of interest.</span>
<span class="sd">    :return: KHIVA Array with the result of calculated coefficients.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">cwt_coefficients</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">tss</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                    <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">widths</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                    <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">coeff</span><span class="p">)),</span>
                                                    <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">w</span><span class="p">)),</span>
                                                    <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="energy_ratio_by_chunks"><a class="viewcode-back" href="../../khiva.html#khiva.features.energy_ratio_by_chunks">[docs]</a><span class="k">def</span> <span class="nf">energy_ratio_by_chunks</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">num_segments</span><span class="p">,</span> <span class="n">segment_focus</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the sum of squares of chunk i out of N chunks expressed as a ratio</span>
<span class="sd">    with the sum of squares over the whole series. segmentFocus should be lower</span>
<span class="sd">    than the number of segments.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :param num_segments: The number of segments to divide the series into.</span>
<span class="sd">    :param segment_focus: The segment number (starting at zero) to return a feature on.</span>
<span class="sd">    :return: KHIVA array with the energy ratio by chunk of the time series.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">energy_ratio_by_chunks</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                          <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_long</span><span class="p">(</span><span class="n">num_segments</span><span class="p">)),</span>
                                                          <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_long</span><span class="p">(</span><span class="n">segment_focus</span><span class="p">)),</span>
                                                          <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="fft_aggregated"><a class="viewcode-back" href="../../khiva.html#khiva.features.fft_aggregated">[docs]</a><span class="k">def</span> <span class="nf">fft_aggregated</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the spectral centroid(mean), variance, skew, and kurtosis of the absolute fourier transform</span>
<span class="sd">    spectrum.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :return: KHIVA array with the spectral centroid (mean), variance, skew, and kurtosis of the absolute fourier transform</span>
<span class="sd">            spectrum.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">fft_aggregated</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="fft_coefficient"><a class="viewcode-back" href="../../khiva.html#khiva.features.fft_coefficient">[docs]</a><span class="k">def</span> <span class="nf">fft_coefficient</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">coefficient</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the fourier coefficients of the one-dimensional discrete</span>
<span class="sd">    Fourier Transform for real input by fast fourier transformation algorithm.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :param coefficient: The coefficient to extract from the FFT.</span>
<span class="sd">    :return: Tuple with:</span>
<span class="sd">        real: KHIVA array with the real part of the coefficient.</span>
<span class="sd">        imag: KHIVA array with the imaginary part of the coefficient.</span>
<span class="sd">        abs: KHIVA array with the absolute value of the coefficient.</span>
<span class="sd">        angle: KHIVA array with the angle of the coefficient.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">fft_coefficient</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                   <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_long</span><span class="p">(</span><span class="n">coefficient</span><span class="p">)),</span>
                                                   <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">),</span>
                                                   <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">c</span><span class="p">),</span>
                                                   <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">d</span><span class="p">),</span>
                                                   <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                                                   <span class="p">)</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">),</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">c</span><span class="p">,</span>
                                           <span class="n">khiva_type</span><span class="o">=</span><span class="n">arr</span><span class="o">.</span><span class="n">khiva_type</span><span class="p">),</span> <span class="n">Array</span><span class="p">(</span>
        <span class="n">array_reference</span><span class="o">=</span><span class="n">d</span><span class="p">),</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">e</span><span class="p">)</span></div>


<div class="viewcode-block" id="first_location_of_maximum"><a class="viewcode-back" href="../../khiva.html#khiva.features.first_location_of_maximum">[docs]</a><span class="k">def</span> <span class="nf">first_location_of_maximum</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the first relative location of the maximal value for each time series.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :return: KHIVA array with the first relative location of the maximum value to the length of the time series, for each</span>
<span class="sd">            time series.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">first_location_of_maximum</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                             <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="first_location_of_minimum"><a class="viewcode-back" href="../../khiva.html#khiva.features.first_location_of_minimum">[docs]</a><span class="k">def</span> <span class="nf">first_location_of_minimum</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the first location of the minimal value of each time series. The position is calculated relatively</span>
<span class="sd">    to the length of the series.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :return: KHIVA array with the first relative location of the minimal value of each series.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">first_location_of_minimum</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                             <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="friedrich_coefficients"><a class="viewcode-back" href="../../khiva.html#khiva.features.friedrich_coefficients">[docs]</a><span class="k">def</span> <span class="nf">friedrich_coefficients</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Coefficients of polynomial :math:`h(x)`, which has been fitted to the deterministic dynamics of Langevin model:</span>
<span class="sd">    Largest fixed point of dynamics  :math:`argmax_x {h(x)=0}` estimated from polynomial :math:`h(x)`,</span>
<span class="sd">    which has been fitted to the deterministic dynamics of Langevin model:</span>

<span class="sd">    .. math::</span>
<span class="sd">        \\dot(x)(t) = h(x(t)) + R \\mathcal(N)(0,1)</span>

<span class="sd">    as described by [1]. For short time series this method is highly dependent on the parameters.</span>

<span class="sd">    [1] Friedrich et al. (2000): Physics Letters A 271, p. 217-222</span>
<span class="sd">    Extracting model equations from experimental data.</span>


<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :param m: Order of polynom to fit for estimating fixed points of dynamics.</span>
<span class="sd">    :param r: Number of quantiles to use for averaging.</span>
<span class="sd">    :return: KHIVA array with the coefficients for each time seriess.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">friedrich_coefficients</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                          <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">m</span><span class="p">)),</span>
                                                          <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">(</span><span class="n">r</span><span class="p">)),</span>
                                                          <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="has_duplicates"><a class="viewcode-back" href="../../khiva.html#khiva.features.has_duplicates">[docs]</a><span class="k">def</span> <span class="nf">has_duplicates</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates if the input time series contain duplicated elements.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :return: KHIVA array containing True if the time series contains duplicated elements</span>
<span class="sd">     and false otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">has_duplicates</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="has_duplicate_max"><a class="viewcode-back" href="../../khiva.html#khiva.features.has_duplicate_max">[docs]</a><span class="k">def</span> <span class="nf">has_duplicate_max</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates if the maximum within input time series is duplicated.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :return: KHIVA array containing True if the maximum value of the time series is duplicated and false otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">has_duplicate_max</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="has_duplicate_min"><a class="viewcode-back" href="../../khiva.html#khiva.features.has_duplicate_min">[docs]</a><span class="k">def</span> <span class="nf">has_duplicate_min</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates if the minimum of the input time series is duplicated.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :return: KHIVA array containing True if the minimum of the time series is duplicated and False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">has_duplicate_min</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="index_mass_quantile"><a class="viewcode-back" href="../../khiva.html#khiva.features.index_mass_quantile">[docs]</a><span class="k">def</span> <span class="nf">index_mass_quantile</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the index of the mass quantile.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :param q: The quantile.</span>
<span class="sd">    :return: KHIVA array with the index of the mass quantile q.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">index_mass_quantile</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                       <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">(</span><span class="n">q</span><span class="p">)),</span>
                                                       <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="kurtosis"><a class="viewcode-back" href="../../khiva.html#khiva.features.kurtosis">[docs]</a><span class="k">def</span> <span class="nf">kurtosis</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Returns the kurtosis of tss (calculated with the adjusted Fisher-Pearson</span>
<span class="sd">    standardized moment coefficient G2).</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :return: KHIVA array with the kurtosis of each time series.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">kurtosis</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                            <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="large_standard_deviation"><a class="viewcode-back" href="../../khiva.html#khiva.features.large_standard_deviation">[docs]</a><span class="k">def</span> <span class="nf">large_standard_deviation</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Checks if the time series within tss have a large standard deviation.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :param r: The threshold.</span>
<span class="sd">    :return: KHIVA array containing True for those time series in tss that have a large standard deviation.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">large_standard_deviation</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                            <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">(</span><span class="n">r</span><span class="p">)),</span>
                                                            <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="last_location_of_maximum"><a class="viewcode-back" href="../../khiva.html#khiva.features.last_location_of_maximum">[docs]</a><span class="k">def</span> <span class="nf">last_location_of_maximum</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the last location of the maximum value of each time series. The position</span>
<span class="sd">    is calculated relatively to the length of the series.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :return: KHIVA array with the last relative location of the maximum value of each series.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">last_location_of_maximum</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                            <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="last_location_of_minimum"><a class="viewcode-back" href="../../khiva.html#khiva.features.last_location_of_minimum">[docs]</a><span class="k">def</span> <span class="nf">last_location_of_minimum</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the last location of the minimum value of each time series. The position</span>
<span class="sd">    is calculated relatively to the length of the series.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :return: KHIVA array the last relative location of the minimum value of each series.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">last_location_of_minimum</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                            <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="length"><a class="viewcode-back" href="../../khiva.html#khiva.features.length">[docs]</a><span class="k">def</span> <span class="nf">length</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Returns the length of the input time series.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :return: KHIVA array the length of tss.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">length</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                          <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="linear_trend"><a class="viewcode-back" href="../../khiva.html#khiva.features.linear_trend">[docs]</a><span class="k">def</span> <span class="nf">linear_trend</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculate a linear least-squares regression for the values of the time series versus the sequence from 0 to</span>
<span class="sd">    length of the time series minus one.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :return  a tuple with:</span>
<span class="sd">            pvalue: KHIVA array the pvalues for all time series.</span>
<span class="sd">            rvalue: KHIVA array The rvalues for all time series.</span>
<span class="sd">            intercept: KHIVA array the intercept values for all time series.</span>
<span class="sd">            slope: KHIVA array the slope for all time series.</span>
<span class="sd">            stdrr: KHIVA array the stderr values for all time series.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">linear_trend</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">),</span>
                                                <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">c</span><span class="p">),</span>
                                                <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">d</span><span class="p">),</span>
                                                <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
                                                <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                                                <span class="p">)</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">),</span> \
           <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">c</span><span class="p">),</span> \
           <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">d</span><span class="p">),</span> \
           <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">e</span><span class="p">),</span> \
           <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">f</span><span class="p">)</span></div>


<div class="viewcode-block" id="local_maximals"><a class="viewcode-back" href="../../khiva.html#khiva.features.local_maximals">[docs]</a><span class="k">def</span> <span class="nf">local_maximals</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates all Local Maximals fot the time series in array.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :return: KHIVA array with the calculated local maximals for each time series in arr.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">local_maximals</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                  <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="longest_strike_above_mean"><a class="viewcode-back" href="../../khiva.html#khiva.features.longest_strike_above_mean">[docs]</a><span class="k">def</span> <span class="nf">longest_strike_above_mean</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the length of the longest consecutive subsequence in tss that is bigger than the mean of tss.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :return: KHIVA array with the length of the longest consecutive subsequence in the input time series that is bigger</span>
<span class="sd">            than the mean.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">longest_strike_above_mean</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                             <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="longest_strike_below_mean"><a class="viewcode-back" href="../../khiva.html#khiva.features.longest_strike_below_mean">[docs]</a><span class="k">def</span> <span class="nf">longest_strike_below_mean</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the length of the longest consecutive subsequence in tss that is below the mean of tss.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :return: KHIVA array with the length of the longest consecutive subsequence in the input time series that is below</span>
<span class="sd">            the mean.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">longest_strike_below_mean</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                             <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="max_langevin_fixed_point"><a class="viewcode-back" href="../../khiva.html#khiva.features.max_langevin_fixed_point">[docs]</a><span class="k">def</span> <span class="nf">max_langevin_fixed_point</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Largest fixed point of dynamics  :math:`argmax_x {h(x)=0}` estimated from polynomial :math:`h(x)`,</span>
<span class="sd">    which has been fitted to the deterministic dynamics of Langevin model</span>

<span class="sd">    .. math::</span>
<span class="sd">        \\dot(x)(t) = h(x(t)) + R \\mathcal(N)(0,1)</span>

<span class="sd">    as described by</span>

<span class="sd">        Friedrich et al. (2000): Physics Letters A 271, p. 217-222</span>
<span class="sd">        *Extracting model equations from experimental data*</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :param m: Order of polynom to fit for estimating fixed points of dynamics.</span>
<span class="sd">    :param r: Number of quantiles to use for averaging.</span>
<span class="sd">    :return: KHIVA array with the largest fixed point of deterministic dynamics.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">max_langevin_fixed_point</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                            <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">m</span><span class="p">)),</span>
                                                            <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">(</span><span class="n">r</span><span class="p">)),</span>
                                                            <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="maximum"><a class="viewcode-back" href="../../khiva.html#khiva.features.maximum">[docs]</a><span class="k">def</span> <span class="nf">maximum</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the maximum value for each time series within tss.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :return: KHIVA array with the maximum value of each time series within tss.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                           <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="mean"><a class="viewcode-back" href="../../khiva.html#khiva.features.mean">[docs]</a><span class="k">def</span> <span class="nf">mean</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the mean value for each time series within tss.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :return: KHIVA array with the mean value of each time series within tss.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="mean_absolute_change"><a class="viewcode-back" href="../../khiva.html#khiva.features.mean_absolute_change">[docs]</a><span class="k">def</span> <span class="nf">mean_absolute_change</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the mean over the absolute differences between subsequent time series values in tss.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :return: KHIVA array with the mean over the absolute differences between subsequent time series values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">mean_absolute_change</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                        <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="mean_change"><a class="viewcode-back" href="../../khiva.html#khiva.features.mean_change">[docs]</a><span class="k">def</span> <span class="nf">mean_change</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the mean over the differences between subsequent time series values in tss.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :return: KHIVA array with the mean over the differences between subsequent time series values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">mean_change</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="mean_second_derivative_central"><a class="viewcode-back" href="../../khiva.html#khiva.features.mean_second_derivative_central">[docs]</a><span class="k">def</span> <span class="nf">mean_second_derivative_central</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates mean value of a central approximation of the second derivative for each time series in tss.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :return: KHIVA array with the mean value of a central approximation of the second derivative for each time series.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">mean_second_derivative_central</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                                  <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="median"><a class="viewcode-back" href="../../khiva.html#khiva.features.median">[docs]</a><span class="k">def</span> <span class="nf">median</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the median value for each time series within tss.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :return: KHIVA array with the median value of each time series within tss.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="minimum"><a class="viewcode-back" href="../../khiva.html#khiva.features.minimum">[docs]</a><span class="k">def</span> <span class="nf">minimum</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the minimum value for each time series within tss.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :return: KHIVA array with the minimum value of each time series within tss.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                           <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="number_crossing_m"><a class="viewcode-back" href="../../khiva.html#khiva.features.number_crossing_m">[docs]</a><span class="k">def</span> <span class="nf">number_crossing_m</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the number of m-crossings. A m-crossing is defined as two sequential values where the first</span>
<span class="sd">    value is lower than m and the next is greater, or viceversa. If you set m to zero, you will get the number of</span>
<span class="sd">    zero crossings.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :param m: The m value.</span>
<span class="sd">    :return: KHIVA array with the number of m-crossings of each time series within tss.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">number_crossing_m</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                     <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">m</span><span class="p">)),</span>
                                                     <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="number_cwt_peaks"><a class="viewcode-back" href="../../khiva.html#khiva.features.number_cwt_peaks">[docs]</a><span class="k">def</span> <span class="nf">number_cwt_peaks</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">max_w</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; This feature calculator searches for different peaks. To do so, the time series is smoothed by a ricker</span>
<span class="sd">    wavelet and for widths ranging from 1 to :math:&#39;max_w`. This feature calculator returns the number of peaks that</span>
<span class="sd">    occur at enough width scales and with sufficiently high Signal-to-Noise-Ratio (SNR).</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :param max_w: The maximum width to consider.</span>
<span class="sd">    :return: KHIVA array with the number of peaks for each time series.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">number_cwt_peaks</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                    <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">max_w</span><span class="p">)),</span>
                                                    <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="number_peaks"><a class="viewcode-back" href="../../khiva.html#khiva.features.number_peaks">[docs]</a><span class="k">def</span> <span class="nf">number_peaks</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the number of peaks of at least support :math:`n` in the time series :math:`tss`. A peak of support</span>
<span class="sd">    :math:`n` is defined as a subsequence of :math:`tss where a value occurs, which is bigger than</span>
<span class="sd">    its :math:`n` neighbours to the left and to the right.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :param n: The support of the peak.</span>
<span class="sd">    :return: KHIVA array with the number of peaks of at least support :math:`n`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">number_peaks</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">n</span><span class="p">)),</span>
                                                <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="partial_autocorrelation"><a class="viewcode-back" href="../../khiva.html#khiva.features.partial_autocorrelation">[docs]</a><span class="k">def</span> <span class="nf">partial_autocorrelation</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">lags</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the value of the partial autocorrelation function at the given lag. The lag :math:`k&#39;`  partial</span>
<span class="sd">    autocorrelation of a time series :math:`\\lbrace x_t, t = 1 \\ldots T \\rbrace` equals the partial correlation of</span>
<span class="sd">    :math:`x_t` and :math:`x_{t-k}`, adjusted for the intermediate variables :math:`\\lbrace x_{t-1}, \\ldots, x_{t-k+1}\\rbrace`</span>
<span class="sd">    ([1]). Following [2], it can be defined as:</span>

<span class="sd">    .. math::</span>
<span class="sd">          \\alpha_k = \\frac{ Cov(x_t, x_{t-k} | x_{t-1}, \\ldots, x_{t-k+1})}</span>
<span class="sd">          {\\sqrt{ Var(x_t | x_{t-1}, \\ldots, x_{t-k+1}) Var(x_{t-k} | x_{t-1}, \\ldots, x_{t-k+1} )}}</span>

<span class="sd">    with (a) :math:`x_t = f(x_{t-1}, \\ldots, x_{t-k+1})` and (b) :math:`x_{t-k} = f(x_{t-1}, \\ldots, x_{t-k+1})`</span>
<span class="sd">    being AR(k-1) models that can be fitted by OLS. Be aware that in (a), the regression is done on past values to</span>
<span class="sd">    predict :math:`x_t` whereas in (b), future values are used to calculate the past value :math:`x_{t-k}`.</span>
<span class="sd">    It is said in [1] that &quot;for an AR(p), the partial autocorrelations :math:`\\alpha_k` will be nonzero for :math:`k&lt;=p`</span>
<span class="sd">    and zero for :math:`k&gt;p`.&quot;</span>
<span class="sd">    With this property, it is used to determine the lag of an AR-Process.</span>

<span class="sd">    [1] Box, G. E., Jenkins, G. M., Reinsel, G. C., &amp; Ljung, G. M. (2015).</span>
<span class="sd">    Time series analysis: forecasting and control. John Wiley &amp; Sons.</span>
<span class="sd">    [2] https://onlinecourses.science.psu.edu/stat510/node/62</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :param lags: KHIVA array with the lags to be calculated.</span>
<span class="sd">    :return: KHIVA array with the partial autocorrelation for each time series for the given lag.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">partial_autocorrelation</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                           <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">lags</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                           <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="percentage_of_reoccurring_datapoints_to_all_datapoints"><a class="viewcode-back" href="../../khiva.html#khiva.features.percentage_of_reoccurring_datapoints_to_all_datapoints">[docs]</a><span class="k">def</span> <span class="nf">percentage_of_reoccurring_datapoints_to_all_datapoints</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">is_sorted</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the percentage of unique values, that are present in the time series more than once.</span>

<span class="sd">    .. math::</span>

<span class="sd">        len(different values occurring more than once) / len(different values)</span>

<span class="sd">    This means the percentage is normalized to the number of unique values, in contrast to the</span>
<span class="sd">    percentage_of_reoccurring_values_to_all_values.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :param is_sorted: Indicates if the input time series is sorted or not. Defaults to false.</span>
<span class="sd">    :return: KHIVA array with the percentage of unique values, that are present in the time series more than once.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">percentage_of_reoccurring_datapoints_to_all_datapoints</span><span class="p">(</span>
        <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
        <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span>
            <span class="n">ctypes</span><span class="o">.</span><span class="n">c_bool</span><span class="p">(</span><span class="n">is_sorted</span><span class="p">)),</span>
        <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span>
            <span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="percentage_of_reoccurring_values_to_all_values"><a class="viewcode-back" href="../../khiva.html#khiva.features.percentage_of_reoccurring_values_to_all_values">[docs]</a><span class="k">def</span> <span class="nf">percentage_of_reoccurring_values_to_all_values</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">is_sorted</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the percentage of unique values, that are present in the time series more than once.</span>

<span class="sd">    .. math::</span>

<span class="sd">        \\frac{\\textit{number of data points occurring more than once}}{\\textit{number of all data points})}</span>

<span class="sd">    This means the percentage is normalized to the number of unique values, in contrast to the</span>
<span class="sd">    percentage_of_reoccurring_datapoints_to_all_datapoints.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :param is_sorted: Indicates if the input time series is sorted or not. Defaults to false.</span>
<span class="sd">    :return: KHIVA array with the percentage of unique values, that are present in the time series more than once.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">percentage_of_reoccurring_values_to_all_values</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                                                  <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span>
                                                                                      <span class="n">ctypes</span><span class="o">.</span><span class="n">c_bool</span><span class="p">(</span><span class="n">is_sorted</span><span class="p">)),</span>
                                                                                  <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="quantile"><a class="viewcode-back" href="../../khiva.html#khiva.features.quantile">[docs]</a><span class="k">def</span> <span class="nf">quantile</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mf">1e8</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Returns values at the given quantile.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :param q: Khiva array with the percentile(s) at which to extract score(s). One or many.</span>
<span class="sd">    :param precision: Number of decimals expected.</span>
<span class="sd">    :return: Values at the given quantile.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                            <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">(</span><span class="n">precision</span><span class="p">)),</span>
                                            <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="range_count"><a class="viewcode-back" href="../../khiva.html#khiva.features.range_count">[docs]</a><span class="k">def</span> <span class="nf">range_count</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Counts observed values within the interval [min, max).</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :param min: Value that sets the lower limit.</span>
<span class="sd">    :param max: Value that sets the upper limit.</span>
<span class="sd">    :return: KHIVA array with the values at the given range.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">range_count</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                               <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="nb">min</span><span class="p">)),</span>
                                               <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">(</span><span class="nb">max</span><span class="p">)),</span>
                                               <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="ratio_beyond_r_sigma"><a class="viewcode-back" href="../../khiva.html#khiva.features.ratio_beyond_r_sigma">[docs]</a><span class="k">def</span> <span class="nf">ratio_beyond_r_sigma</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the ratio of values that are more than :math:`r*std(x)` (so :math:`r` sigma) away from the mean of</span>
<span class="sd">    :math:`x`.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :param r: Number of times that the values should be away from.</span>
<span class="sd">    :return: KHIVA array with the ratio of values that are more than :math:`r*std(x)` (so :math:`r` sigma) away from</span>
<span class="sd">            the mean of :math:`x`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">ratio_beyond_r_sigma</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                        <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">(</span><span class="n">r</span><span class="p">)),</span>
                                                        <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="ratio_value_number_to_time_series_length"><a class="viewcode-back" href="../../khiva.html#khiva.features.ratio_value_number_to_time_series_length">[docs]</a><span class="k">def</span> <span class="nf">ratio_value_number_to_time_series_length</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates a factor which is 1 if all values in the time series occur only once, and below one if this is</span>
<span class="sd">    not the case. In principle, it just returns:</span>

<span class="sd">    .. math::</span>
<span class="sd">        \\frac{\\textit{number unique values}}{\\textit{number values}}</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :return: KHIVA array with the ratio of unique values with respect to the total number of values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">ratio_value_number_to_time_series_length</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                                            <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="sample_entropy"><a class="viewcode-back" href="../../khiva.html#khiva.features.sample_entropy">[docs]</a><span class="k">def</span> <span class="nf">sample_entropy</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates a vectorized sample entropy algorithm.</span>
<span class="sd">    https://en.wikipedia.org/wiki/Sample_entropy</span>
<span class="sd">    https://www.ncbi.nlm.nih.gov/pubmed/10843903?dopt=Abstract</span>
<span class="sd">    For short time-series this method is highly dependent on the parameters, but should be stable for N &gt; 2000,</span>
<span class="sd">    see: Yentes et al. (2012) - The Appropriate Use of Approximate Entropy and Sample Entropy with Short Data Sets</span>
<span class="sd">    Other shortcomings and alternatives discussed in:</span>
<span class="sd">    Richman &amp; Moorman (2000) - Physiological time-series analysis using approximate entropy and sample entropy.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :return: KHIVA array with the same dimensions as tss, whose values (time series in dimension 0)</span>
<span class="sd">            contains the vectorized sample entropy for all the input time series in tss.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">sample_entropy</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="skewness"><a class="viewcode-back" href="../../khiva.html#khiva.features.skewness">[docs]</a><span class="k">def</span> <span class="nf">skewness</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the sample skewness of tss (calculated with the adjusted Fisher-Pearson standardized</span>
<span class="sd">    moment coefficient G1).</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :return: KHIVA array containing the skewness of each time series in tss.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">skewness</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="spkt_welch_density"><a class="viewcode-back" href="../../khiva.html#khiva.features.spkt_welch_density">[docs]</a><span class="k">def</span> <span class="nf">spkt_welch_density</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">coeff</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Estimates the cross power spectral density of the time series array at different frequencies. To do so, the</span>
<span class="sd">    time series is first shifted from the time domain to the frequency domain.</span>

<span class="sd">    Welch&#39;s method computes an estimate of the power spectral density by dividing the data into overlapping</span>
<span class="sd">    segments, computing a modified periodogram for each segment and averaging the periodograms.</span>
<span class="sd">    [1] P. Welch, &quot;The use of the fast Fourier transform for the estimation of power spectra: A method based on time</span>
<span class="sd">    averaging over short, modified periodograms&quot;, IEEE Trans. Audio Electroacoust. vol. 15, pp. 70-73, 1967.</span>
<span class="sd">    [2] M.S. Bartlett, &quot;Periodogram Analysis and Continuous Spectra&quot;, Biometrika, vol. 37, pp. 1-16, 1950.</span>
<span class="sd">    [3] Rabiner, Lawrence R., and B. Gold. &quot;Theory and Application of Digital Signal Processing&quot; Prentice-Hall, pp.</span>
<span class="sd">    414-419, 1975.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :param coeff: The coefficient to be returned.</span>
<span class="sd">    :return: KHIVA array containing the power spectrum of the different frequencies for each time series in arr.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">spkt_welch_density</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                      <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">coeff</span><span class="p">)),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="standard_deviation"><a class="viewcode-back" href="../../khiva.html#khiva.features.standard_deviation">[docs]</a><span class="k">def</span> <span class="nf">standard_deviation</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the standard deviation of each time series within tss.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :return: KHIVA array with the standard deviation of each time series within tss.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                      <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="sum_of_reoccurring_datapoints"><a class="viewcode-back" href="../../khiva.html#khiva.features.sum_of_reoccurring_datapoints">[docs]</a><span class="k">def</span> <span class="nf">sum_of_reoccurring_datapoints</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">is_sorted</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the sum of all data points, that are present in the time series more than once.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :param is_sorted: Indicates if the input time series is sorted or not. Defaults to false.</span>
<span class="sd">    :return: KHIVA array with the sum of all data points, that are present in the time series more than once.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">sum_of_reoccurring_datapoints</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                                 <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_bool</span><span class="p">(</span><span class="n">is_sorted</span><span class="p">)),</span>
                                                                 <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="sum_of_reoccurring_values"><a class="viewcode-back" href="../../khiva.html#khiva.features.sum_of_reoccurring_values">[docs]</a><span class="k">def</span> <span class="nf">sum_of_reoccurring_values</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">is_sorted</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the sum of all values, that are present in the time series more than once.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :param is_sorted: Indicates if the input time series is sorted or not. Defaults to false.</span>
<span class="sd">    :return: KHIVA array with the sum of all values, that are present in the time series more than once.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">sum_of_reoccurring_values</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                             <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_bool</span><span class="p">(</span><span class="n">is_sorted</span><span class="p">)),</span>
                                                             <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="sum_values"><a class="viewcode-back" href="../../khiva.html#khiva.features.sum_values">[docs]</a><span class="k">def</span> <span class="nf">sum_values</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the sum over the time series arr.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :param is_sorted: Indicates if the input time series is sorted or not. Defaults to false.</span>
<span class="sd">    :return: KHIVA array with the sum of values in each time series.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">sum_values</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                              <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="symmetry_looking"><a class="viewcode-back" href="../../khiva.html#khiva.features.symmetry_looking">[docs]</a><span class="k">def</span> <span class="nf">symmetry_looking</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates if the distribution of tss *looks symmetric*. This is the case if</span>

<span class="sd">    .. math::</span>

<span class="sd">         | mean(tss)-median(tss)| &lt; r * (max(tss)-min(tss))</span>


<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :param r: The percentage of the range to compare with.</span>
<span class="sd">    :return: KHIVA array denoting if the input time series look symmetric.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">symmetry_looking</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                    <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">(</span><span class="n">r</span><span class="p">)),</span>
                                                    <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="time_reversal_asymmetry_statistic"><a class="viewcode-back" href="../../khiva.html#khiva.features.time_reversal_asymmetry_statistic">[docs]</a><span class="k">def</span> <span class="nf">time_reversal_asymmetry_statistic</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">lag</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; This function calculates the value of:</span>

<span class="sd">    .. math::</span>

<span class="sd">        \\frac{1}{n-2lag} \\sum_{i=0}^{n-2lag} x_{i + 2 \\cdot lag}^2 \\cdot x_{i + lag} - x_{i + lag} \\cdot  x_{i}^2</span>

<span class="sd">    which is</span>

<span class="sd">    .. math::</span>

<span class="sd">        \\mathbb{E}[L^2(X)^2 \\cdot L(X) - L(X) \\cdot X^2]</span>

<span class="sd">    where :math:`\\mathbb{E}` is the mean and :math:`L` is the lag operator. It was proposed in [1] as a promising</span>
<span class="sd">    feature to extract from time series.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :param lag: The lag to be computed.</span>
<span class="sd">    :return: KHIVA array containing the count of the given value in each time series.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">time_reversal_asymmetry_statistic</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                                     <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">(</span><span class="n">lag</span><span class="p">)),</span>
                                                                     <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="value_count"><a class="viewcode-back" href="../../khiva.html#khiva.features.value_count">[docs]</a><span class="k">def</span> <span class="nf">value_count</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Counts occurrences of value in the time series tss.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :param v: The value to be counted.</span>
<span class="sd">    :return: KHIVA array containing the count of the given value in each time series.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">value_count</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span><span class="p">(</span><span class="n">v</span><span class="p">)),</span>
                                               <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="variance"><a class="viewcode-back" href="../../khiva.html#khiva.features.variance">[docs]</a><span class="k">def</span> <span class="nf">variance</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Computes the variance for the time series array.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :return: KHIVA array containing the variance in each time series.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">variance</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="variance_larger_than_standard_deviation"><a class="viewcode-back" href="../../khiva.html#khiva.features.variance_larger_than_standard_deviation">[docs]</a><span class="k">def</span> <span class="nf">variance_larger_than_standard_deviation</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates if the variance of array is greater than the standard deviation. In other words, if the variance of</span>
<span class="sd">    array is larger than 1.</span>

<span class="sd">    :param arr: KHIVA array with the time series.</span>
<span class="sd">    :return: KHIVA array denoting if the variance of array is greater than the standard deviation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">KhivaLibrary</span><span class="p">()</span><span class="o">.</span><span class="n">c_khiva_library</span><span class="o">.</span><span class="n">variance_larger_than_standard_deviation</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">arr_reference</span><span class="p">),</span>
                                                                           <span class="n">ctypes</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Array</span><span class="p">(</span><span class="n">array_reference</span><span class="o">=</span><span class="n">b</span><span class="p">)</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Shapelets

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>